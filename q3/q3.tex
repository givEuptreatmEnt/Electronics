\documentclass[12pt, a4paper]{article}
\input{header.tex}

%% Note that for label to be correct, compile more than 2 times is needed ... %%


%%%%%%%%%%%%%%%Title的資訊%%%%%%%%%%%%%%%
\title{} %標題
\author{} %作者
\date{} %日期


\begin{document}
\tikzstyle{default}=[thick, color=black]
% \maketitle %製作tilte page
% \thispagestyle{empty}  %去除頁碼
% \thispagestyle{fancy}  %使用fancyhdr
% \tableofcontents %目錄
%%%%%%%%%%%%%%%%%%%include file here%%%%%%%%%%%%%%%%%%%%%%%%%
% 7: 9
\section{5.10}
Consider an n-channel MOSFET with $t_{ox} = \SI{20}\nm$, $\mu_{n} = \SI{650}{\cm\squared\per\V\per\s}$, $V_t = \SI{0.8}\V$ and $W/L = 10$. Find the drain current in the following cases:

\begin{enumerate}[label=(\alph*)]
  \item $v_{GS} = \SI{5}{\V}$ and $v_{DS} = \SI{1}{\V} $\\[5pt]
    \Ans \\
    First we calculate 
    \[ k_n = \mu_n C_{ox} (W / L) = \mu_n \varepsilon_{ox} (W / L) /  t_{ox} \approx \SI{1.12}{\mA\per\V\squared} \]
    Since $v_{GS} > V_t$ and $v_{GS} - v_{DS} = \SI{4}{\V} > V_t$, the MOS is working on the triode region, so 
    \[
      i_D =  k_n \left(v_{GS} - V_t - \frac{1}{2}v_{DS} \right)v_{DS} \approx \SI{4.14}{\mA} 
    \]
  \item $v_{GS} = \SI{2}{\V}$ and $v_{DS} = \SI{1.2}{\V} $\\[5pt]
    \Ans \\
    Now $V_{GS} > V_t$ and $V_{GS} - V_{DS} = \SI{0.8}{\V} = V_t$, the MOS is working on the boundary of the saturation and the triode region, so 
    \[
      i_D = \frac{1}{2} k_n (V_{GS} - V_t)^2 \approx \SI{1.61}{\mA} 
    \]
  \item $v_{GS} = \SI{5}{\V}$ and $v_{DS} = \SI{0.2}{\V} $\\[5pt]
    \Ans \\
    Again $V_{GS} > V_t$ and $V_{GS} - V_{DS} = \SI{4.8}{\V} > V_t$, the MOS is working on the triode region, so 
    \[
      i_D =  k_n \left(v_{GS} - V_t - \frac{1}{2}v_{DS} \right)v_{DS} \approx \SI{0.92}{\mA} 
    \]
  \item $v_{GS} = \SI{5}{\V}$ and $v_{DS} = \SI{5}{\V} $\\[5pt]
    \Ans \\
    Finally since $V_{GS} > V_t$ and $V_{GS} - V_{DS} = \SI{0}{\V} < V_t$, the MOS is working on the saturation region, so 
    \[
      i_D =  \frac{1}{2} k_n (v_{GS} - V_t)^2 \approx \SI{9.88}{\mA} 
    \]
\end{enumerate}
% 18: 23
\section{5.20}
The table below lists 10 different cases labeled (a) to (j) for operating an NMOS transistor with $V_t = \SI{1}{\V} $. In each case the voltages at the source, gate, and drain (relative to the circuit ground) are specified. You are required to complete the tabel entries. Note that if you encounter a case for which $v_{DS}$ is negative, you should exchange the drain and source before solving the problem. You can do this because the MOSFET is a symmetric device.


\Ans \\
\begin{center}
  \begin{tabular}{|l|c|c|c|c|c|c|c|}
    \hline
    & \multicolumn{6}{c|}{Voltage \si\V} & \\ \cline{2-7}
    Case & $V_S$ & $V_G$ & $V_D$ & $V_{GS}$ & $V_{OV}$ & $V_{DS}$ & Region of operation \\
    \hline
    a & $+1.0$ & $+1.0$ & $+2.0$ & $0$ & $0$ & $1.0$ & Cut-off \\
    b & $+1.0$ & $+2.5$ & $+2.0$ & $1.5$ & $0.5$ & $1.0$ & Saturation \\
    c & $+1.0$ & $+2.5$ & $+1.5$ & $1.5$ & $0.5$ & $0.5$ & Boundary of Sat./Tri. \\
    d & $+1.0$ & $+1.5$ & $+2.0$ & $0.5$ & $0$ & $1.0$ & Cut-off \\
    e & $0$ & $+2.5$ & $+1.0$ & $2.5$ & $1.5$ & $1$ & Triode \\
    f & $+1.0$ & $+1.0$ & $+1.0$ & $0$ & $0$ & $0$ & Cut-off \\
    g & $-1.0$ & $0$ & $0$ & $1.0$ & $0$ & $1.0$ & Boundary of Cut./Sat. \\
    h & $-1.5$ & $0$ & $0$ & $1.5$ & $0.5$ & $1.5$ & Saturation \\
    i & $-1.0$ & $0$ & $+1.0$ & $1.0$ & $0$ & $2.0$ & Saturation \\
    j & $+0.5$ & $+2.0$ & $+0.5$ & $1.5$ & $0.5$ & $0$ & Triode \\
    \hline
  \end{tabular}
\end{center}

\clearpage
% 21: 26
\section{5.29}

% 38: 46
\section{5.34}
The NMOS transistors in the circuit of  Fig.~\ref{fig:3.38} have $V_t = \SI{1}{\V} , \mu_n C_{ox} = \SI{120}{\uA\per\V\squared}, \lambda = 0$ and $L_1 = L_2 = L_3 = \SI{1}{\um} $. Find the required values of gate width for each of $Q_1$, $Q_2$, and $Q_3$ to obtain the voltage and current values indicated.

\begin{figure}[H]
  \centering
  \begin{circuitikz}[>=triangle 45, scale=1, transform shape]
    \draw[default] (0, 1) node[nmos, label={[shift={(0.4, -0.3)}]$Q_1$}](nm1){};
    \draw[default] (0, 2.5) node[nmos, label={[shift={(0.4, -0.3)}]$Q_2$}](nm2){};
    \draw[default] (0, 4) node[nmos, label={[shift={(0.4, -0.3)}]$Q_3$}](nm3){};
    \draw[color=black, thick] let \p1=(nm1) in
    (0, \x1) node[ground]{} to [short] (nm1.source);
    \draw[default] (nm1.gate) |- (nm1.drain) to[short, *-o] ++(0.5, 0) node[right]{$+\SI{1.5}{\V}$};
    \draw[default] (nm2.gate) |- (nm2.drain) to[short, *-o] ++(0.5, 0) node[right]{$+\SI{3.5}{\V}$};
    \draw[default] (nm3.gate) |- (nm3.drain) to[short, *-, i<_=120<\uA>] ++(0, 0.5);
    \draw[color=black, thick, ->]
      ($(nm3.drain) + (0, 0.3)$) to ++(0, 0.5) node[above]{$+\SI{5}{\V}$}
      ;
  \end{circuitikz}
  \caption{}
  \label{fig:3.38}
\end{figure}

\Ans \\
Notice that every MOS is working on saturation region, since $v_D = v_G$,  hence $v_{DS} > v_{GS} - V_t$. Now for $Q_1, Q_3$, $V_{OV} = v_{GS} - V_t = \SI{0.5}{\V} $ and for $Q_2$, $V_{OV} = \SI{1}{\V} $.
Hence by solving 
\[
  \frac{1}{2} \mu_n C_{ox} \frac{W}{L} V_{OV}^2 = I_D = \SI{120}{\uA} 
\]
We get $W_1 = W_3 = \SI{4}{\um} , W_2 = \SI{2}{\um} $

% 40: 48
\section{5.41}
For the devices in the circuits of Figure~\ref{fig:5.41}, $ \abs{V_t} = \SI{1}{V} , \lambda = 0, \mu_n C_{ox} = \SI{50}{\uA\per\V\squared}, L = \SI{1}{\um}$, and $W = \SI{10}{\um}$. Find $V_2$ and $I_2$. How do these values change if $Q_3$ and $Q_4$ are made to have $W = \SI{100}{\um}$?
\begin{figure}[H]
  \centering
  \begin{circuitikz}[>=triangle 45]
    \draw[default] (0, 0) node[nmos, xscale=-1] (Q3) {}
    (Q3.S) node[ground] {}
    (Q3.D) to[short, i<_=$I_2$] ++(0, 0.5) node[](p1){} to [short, *-o] ++(-0.5, 0) node[left]{$V_2$}
    (p1) to[short] ++(0, 0.5) node[nmos, anchor=S](Q4){}
    (Q3.G) to[short] ++(0.5, 0) node[circ](p2){} to[short] ++(0.5, 0) node[nmos, anchor=G](Q1) {}
    (Q1.S) node[ground]{}
    (p2) |- ($(Q1.D) + (0, 0.5)$) node[circ](p3){} -- (Q1.D)
    (p3) to[short, i<^={\color{blue}$I_1$}] ++(0, 0.5) node[nmos, xscale=-1.0, anchor=S](Q2){}
    (Q1) node[right]{$Q_1$}
    (Q2) node[left]{$Q_2$}
    (Q3) node[left]{$Q_3$}
    (Q4) node[right]{$Q_4$}
    ($(p2) + (0, 4.5)$) node[]{$+\SI{5}{\V}$}
    (p3) node[right]{\color{blue}$V_1$}
    ; 
    \draw[default, ->] (Q4.D) -- ++(0, 1);
    \draw[default, ->] (Q4.G) -| ++(-0.2, 1.75);
    \draw[default, ->] (Q2.D) -- ++(0, 1);
    \draw[default, ->] (Q2.G) -| ++(0.2, 1.75);
    \draw[dashed, color=blue] (p1) -- (p3);
  \end{circuitikz}
  \caption{}
  \label{fig:5.41}
\end{figure}


\Ans \\
Notice that if we connect the blue dashed line in the figure, the circuit is now symmetric. Moreover, all the MOS are working in saturation region.
Now $Q_1, Q_2, Q_3, Q_4$ has the same $k_n$, and the current go through $Q_4, Q_2$ is equal to the current that go through $Q_3, Q_1$. So by symmetry, $V_2 = V_1 =  \SI{5}{V} / 2 = \SI{2.5}{\V}$. Notice that there is no currenct go through the blue dashed line, so if we remove the line, the voltage remains unchanged. Hence we know that in the origin circuit, $V_2 = \SI{2.5}{\V}$.
\begin{align*}
  k_n &= \mu_n C_{ox} (W / L) = \SI{0.5}{\mA} \\
  V_2 &= v_{GS} = \SI{2.5}{\V} \\
  I_2 &= \frac{1}{2} k_n (v_{GS} - V_t) ^2 = \SI{562.5}{\uA}
\end{align*}
Simmilarly, if now $W_{3,4} = \SI{100}{\um}$, $k_n$ is $10$ times greater than before, so $I_2 = \SI{5.625}{\mA}$.

% 45: 53
\section{5.43}

\section{5.46}
Figure~\ref{fig:5.46} shows an amplifier in which the load resistor $R_D$ has been replaced with another NMOS transistor $Q_1$ connected as a two-terminal device. Note that because $v_{DG}$ of $Q_2$ is zero, it will be operating in saturation at all times, even when $v_I = 0$ and $i_{D2} = i_{D1} = 0$. Note also that the two transistors conduct equal drain currents. Using $i_{D1} = i_{D2}$, show that for the range of $v_I$ over which $Q_1$ is operating in saturation, that is , for
\[ V_{t1} \leq v_I \leq v_O +V_{t1} \]
the output voltage will be given by
\[ v_O = V_{DD} - V_t + \sqrt{ \frac{W_1/L_1}{W_2/L_2} }V_t - \sqrt{ \frac{W_1/L_1}{W_2/L_2} }v_I \]

\begin{figure}[H]
  \centering
  \begin{circuitikz}[>=triangle 45]
    \draw[default] 
    (0, 0) node[ground]{} node[nmos, anchor=S](Q1){}
    (Q1.G) to[short, -o] ++(-0.5, 0) node[left]{$v_I$}
    (Q1.D) to[short, i^<={\color{red}$i_{D1}$}] ++(0, 0.5) node[](p1){} to[short, *-o] ++(0.5, 0) node[right]{$v_O$}
    (p1) to[short] ++(0, 0.5) node[nmos, anchor=S](Q2){}
    ($(Q2.D) + (0, 0.5)$) node[circ](p2){} -| (Q2.G)
    (p2) to[short, i^>={\color{red}$i_{D2}$}] (Q2.D)
    (Q1) node[right] {$Q_1$}
    (Q2) node[right] {$Q_2$}
      ;
      
    \draw[default, ->] (p2) -- ++(0, 0.5) node[above]{$V_{DD}$};
  \end{circuitikz}
  \caption{}
  \label{fig:3.45}
\end{figure}

\Ans
Since both the MOS is operating in saturation, we have
\begin{align*}
  i_{D1} &= \frac{1}{2} k'_n \frac{W_1}{L_1} (v_I - V_t)^2 \\
  i_{D2} &= \frac{1}{2} k'_n \frac{W_2}{L_2} (V_{DD} - v_O - V_t)^2 
\end{align*}

By $i_{D1} = i_{D2}$ we obtain
\begin{gather*}
  \frac{W_1}{L_1} (v_I - V_t)^2 = \frac{W_2}{L_2} (V_{DD} - v_O - V_t)^2 \\
  \Rightarrow v_O = V_{DD} - V_t + \sqrt{ \frac{W_1/L_1}{W_2/L_2} } (V_t - v_I) 
\end{gather*}
Which is the desired result.

% 48: 56
\section{5.50}
In this problem we investigate an optimum design of the CS amplifier circuit of Figure~\ref{fig:}. First. use the voltage gain expression $A_v = -g_m R_D$ together with Eq(5.57) for $g_m$ to show that
\[ A_v = -\frac{2I_D R_D}{V_{OV}} = - \frac{2(V_{DD} - V_D)}{V_{OV}} \]
Next, let the maximum positive input signal be $\hat{v_i}$. To keep the second-harmonic distortion to an acceptable level, we bias the MOSFET to operate at an overdrive voltage $V_{OV} \gg \hat{v_i}$. Let $V_{OV} = m\hat{v_i}$. Now, to maximize the voltage gain $\abs{A_v}$, we design for the lowest possible $V_D$. Show that the minimum $V_D$ that is consistent with allowing a negative signal voltage swing at the drain of $\abs{A_v}\hat{v_i}$ while maintaining saturation-mode operation is given by
\[
  V_D = \frac{V_{OV} + \hat{v_i} + 2 V_{DD} (\hat{v_i}/V_{OV})}{1 + 2(\hat{v_i}/V_{OV})} 
\]
Now, find $V_{OV}, V_D, A_v$, and $\hat{v_o}$ for the case $V_{DD} = \SI{3}{\V}, \hat{v_i} = \SI{20}{\mV}, \text{and } m = 10$. If it is desired to operate this transistor at $I_D = \SI{100}{\uA}$, find the values of $R_D$ and $W/L$, assuming that for this process technology $k'_n = \SI{100}{\uA\per\V\squared}$.

\Ans\\
\begin{align*}
  g_m &= \frac{2I_D}{V_{OV}}\\
  A_v &= -g_m R_D = -\frac{2 I_D R_D}{V_{OV}}  = -\frac{2 (V_{DD} - V_D)}{V_{OV}} 
\end{align*}
Let $v_g = V_G + v_i$ be the total gate voltage, $v_d = V_D + A_v v_i$ be the total drain voltage, the saturation condition required that $v_d \geq v_g - V_t$. so
\begin{align*}
  & v_d \geq v_g - V_t \\
  \Rightarrow & V_D + A_v v_i \geq V_G + v_i - V_t  \\
  \Rightarrow & V_D - \frac{2 (V_{DD} - V_D)}{V_{OV}} v_i \geq V_G + v_i - V_t \\
  \Rightarrow  & V_D - \frac{2 (V_{DD} - V_D)}{V_{OV}} \hat{v_i} \geq V_G + \hat{v_i} - V_t \quad \footnotemark \\
  \Rightarrow & \left(1 + \frac{2\hat{v_i}}{V_{OV}}\right) V_D \geq V_G + \hat{v_i} + \frac{2V_{DD}}{V_{OV}} \hat{v_i}  - V_t  \\
  \Rightarrow & V_D \geq \frac{V_{OV} + \hat{v_i} + 2 V_{DD} (\hat{v_i} / V_{OV}) }{1 + 2(\hat{v_i}/V_{OV})} 
\end{align*}
\footnotetext{Since $A_v, v_i$ and $v_i$ are in opposite sign, so in the worse case, we shall consider $-A_v \hat{v_i}$ and $\hat{v_i}$}
Which is the desired result.
Plug in the value and let $V_D$ be the maximum possible value we found out that
\begin{alignat*}{3}
  & V_{OV} &&= m \hat{v_i} && = \SI{200}{\mV} \\
  & V_{D} &&= \frac{V_{OV} + \hat{v_i} + 2 V_{DD} (\hat{v_i} / V_{OV}) }{1 + 2(\hat{v_i}/V_{OV})} && \approx \SI{683}{\mV} \\
  & A_v &&= -\frac{2(V_{DD} - V_D)}{V_{OV}}  && \approx -23.2 \\
  & \hat{v_o} &&= \abs{A_v} \hat{v_i} && \approx \SI{464}\mV \\
\end{alignat*}
If moreover, $I_D = \SI{100}{\uA}$,
\begin{alignat*}{3}
  & R_D &&= \frac{V_{DD} - V_D}{I_D}  && \approx \SI{23.17}{\kohm} \\
  & \frac{W}{L} &&= I_D / \left(\frac{1}{2} k'_n V_{OV}^2 \right) && = 50
\end{alignat*}


% 52: 61
\section{3.52}
Design a 7.5-\si{\V} zener regulator circuit using a 7.5-\si{\V}
zener specified at \SI{12}{\mA}. The zener has an incremental
resistance $r_z = \SI{30}{\ohm}$ and a knee current of \SI{0.5}{\mA}.
The regulator operates from a 10-\si{\V} supply and has a
1.2-\si{\kohm} load. What is the value of $R$ you have chosen?
What is the regulator output voltage when the supply is \SI{10}{\percent}
high? Is \SI{10}{\percent} low? What is the output voltage when both the
supply is \SI{10}{\percent} high and the load is removed? What is
the smallest possible load resistor that can be ued while the zener
operates at a current no lower than the knee current while the supply
is \SI{10}{\percent} low? What is the load voltage in this case?

\Ans \\
First calculate $V_{Z0} = V_Z - r_z I_Z = \SI{7.14}{\V}$. Now we need to
choose a value of $R$ such that the current $I_D$ flowing into the zener diode
is not smaller that the knee current of that diode. We have
$V_O = I_Dr_z + V_{Z0}$, so
\[
  \left((1/(\SI{1.2}{\kohm}) + (1/R)\right) V_O + I_D - 10/R = 0
    \quad \text{and} \quad I_D \ge \SI{0.5}{\mA}.
\]
We choose $R = \SI{200}{\ohm}$ as an example.
Now we obtain the equality:
\[ \left((1/R_L) + (1/r_z) + (1/R)\right)V_O = V_S/R + V_{Z0}/r_z \]
where $R_L$ is the load resistance, $V_S$ is the supply voltage. \\
When the supply is \SI{10}{\percent} high, $V_O \approx \SI{7.48}{\V}$. \\
When the supply is \SI{10}{\percent} low, $V_O \approx \SI{7.23}{\V}$. \\
If supply is \SI{10}{\percent} high and load resistor is removed,
then $R_L = \infty$, $V_O \approx \SI{7.64}{\V}$.
Since $I_D = (V_O - V_{Z0})/r_z$ must greater that \SI{0.5}{\mA}, we have
$V_O \ge \SI{7.155}{\V}$. So the smallest value of $R_L$ when supply is
\SI{10}{\percent} low is \SI{561}{\ohm} approximately. And the load voltage
is equal to $V_O \approx \SI{7.155}{\V}$.

% 53: 63
\section{3.53}
A zener shunt regulator employ a 9.1-\si{\V} zener diode for which
$V_Z = \SI{9.1}{\V}$ at $I_Z = \SI{9}{\mA}$, with $r_z = \SI{30}{\ohm}$
and $I_{ZK}=\SI{0.3}{\mA}$. The available supply voltage of \SI{15}{\V}
can vary as much as $\pm\SI{10}{\percent}$.
\begin{enumerate}[(a)]
  \item For this diode, what is the value of $V_{Z0}$?
  \item For a nominal load resistance $R_L$ of \SI{1}{\kohm}
and a nominal zener current of \SI{10}{\mA}, what current must flow
in the supply resistor $R$?
  \item For the nominal value of supply voltage, select a value for resistor $R$, specified to one significant digit, to provide at least that current. What nominal output voltage results?
  \item For a $\pm\SI{10}{\percent}$ change in the supply voltage, what variation
in output voltage results?
  \item If the load current is reduced by
\SI{50}{\percent}, what increase in $V_O$ results?
  \item What is the smallest value of load resistance that can be tolerated while maintaining
regulation when the supply voltage is low?  What is the lowest possible output voltage that results? 
  \item Calculate values for the line regulation
and for the load regulation for this circuit using the numerical results
obtained in this problem.
\end{enumerate}

\Ans \\
\begin{enumerate}[(a)]
  \item $V_{Z0} = V_Z - r_z I_Z = \SI{8.83}{\V}$.
  \item If nominal zener current is \SI{10}{\mA}, then $V_O = V_{Z0} + \SI{10}{\mA} \cdot r_z = \SI{9.13}{\V}$.
So the current flowing into $R$ is equal to $V_O/R_L + \SI{10}{\mA} =
\SI{19.13}{\mA}$.
  \item Since $(V_S - V_O)/R \ge \SI{19.13}{\mA}$,
$R \le \SI{306.8}{\ohm} \Rightarrow R \approx \SI{300}{\ohm}$. And we have
$V_O \approx \SI{9.14}{\V}$ when $R = \SI{300}{\ohm}$. 
  \item When $V_S$ is \SI{10}{\percent} high, $V_O \approx \SI{9.27}{\V}$. When $V_S$ is \SI{10}{\percent} low, $V_O \approx \SI{9.01}{\V}$.
  \item If load current is reduced by \SI{50}{\percent}, then we have load current
$I_L = \SI{4.57}{\mA}$. Thus
\[ \frac{V_S - V_O}{R} = I_L + \frac{V_O - V_{Z0}}{r_z}
  \; \Rightarrow \; V_O \approx \SI{9.27}{\V}. \]
  \item The load resistance should not be too small so that $I_D$ is smaller than
$I_{ZK}$. So we can obtain the inequality:
\[ \frac{V_O - V_{Z0}}{r_z} \ge I_{ZK} \; \Rightarrow \;
V_O \ge \SI{8.839}{\V}, R_L \ge \SI{436.8}{\ohm}. \]
\item Line regulation: $\Delta V_O/ \Delta V_S \approx \SI{8.67}{\percent}$. \\
Load regulation: $\Delta V_O/I_L \approx \SI{-27.3}{\mV/\mA}$.
\end{enumerate}

% 60: 74
\section{3.60}
The circuit in Fig.~\ref{fig:3.60} implements a complementary-output
rectifier. Sketch and clearly label the waveforms of $v_O^+$ and $v_O^-$.
Assume a 0.7-\si{\V} drop across each conducting diode. If the
magnitude of the average of each output is to be \SI{15}{\V}, find
the required amplitude of the sine wave across the entire secondary
winding. What is the PIV of each diode?

\begin{figure}[H]
  \caption{}
  \label{fig:3.60}
\end{figure}

Let $v_D = \SI{0.7}\V$. When $v_S$ is positive, $D_3, D_4$ is on. When $v_S$ is negative, 
$D_1, D_2$ is on. The average of each output is equal to
\[
  \int\limits_{\substack{0 \leq t \leq T \\ v_s > v_D}} \frac{v_s - v_D}{T} \iD t = \int_{\alpha}^{T-\alpha} \frac{v_s - v_D}{T} \iD t
\]
Where $\alpha = \arcsin(v_D/v_s) T / \pi$. But since $v_D \ll v_s$, $\alpha \rightarrow 0$, so the average is $(2/\pi) v_S - v_D$ approximately, so the amplitude of $v_S$ is about to
$\SI{24.66}{\V}$.
And the PIV of each diode is $2v_S - v_D \approx \SI{48.6}{\V}$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \bibliographystyle{plain}
% \begin{thebibliography}{99}
% \bibitem[1]{ex}\url{http://www.example.com/}
% \end{thebibliography}
\end{document}
